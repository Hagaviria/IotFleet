<div class="sensor-data-management">
  <p-toast></p-toast>

  <div class="flex justify-content-between align-items-center mb-4">
    <div class="flex gap-2">
      <p-button label="Crear Datos de Sensor" icon="pi pi-plus" (onClick)="showCreateSensorDataDialog()"
        [loading]="isLoading()">
      </p-button>

      @if (!isSimulating()) {
      <p-button label="Iniciar Simulación" icon="pi pi-play" severity="success" (onClick)="startSimulation()">
      </p-button>
      } @else {
      <p-button label="Detener Simulación" icon="pi pi-stop" severity="danger" (onClick)="stopSimulation()">
      </p-button>
      }
    </div>
  </div>

  @if (isSimulating()) {
  <p-card class="mb-4">
    <div class="flex align-items-center gap-3">
      <i class="pi pi-spin pi-spinner text-blue-500"></i>
      <span class="text-blue-600 font-medium">Simulación activa - Generando datos cada 5 segundos</span>
      <p-tag value="ACTIVO" severity="success"></p-tag>
    </div>
  </p-card>
  }

  <p-card class="mb-4">
    <div class="grid">
      <div class="col-12 md:col-6">
        <h4 class="font-medium text-gray-700 mb-2">Datos que se Envían:</h4>
        <ul class="list-disc list-inside text-sm text-gray-600 space-y-1">
          <li><strong>📍 Ubicación GPS:</strong> Latitud, Longitud, Altitud</li>
          <li><strong>⛽ Combustible:</strong> Nivel actual, Consumo</li>
          <li><strong>🌡️ Temperatura:</strong> Motor y Ambiente</li>
          <li><strong>🚗 Velocidad:</strong> Velocidad actual</li>
        </ul>
      </div>
    </div>
  </p-card>

  <p-dialog header="Crear Datos de Sensor" [(visible)]="showCreateDialog" [modal]="true" [style]="{ width: '700px' }"
    [closable]="true" [draggable]="false" [resizable]="false">

    <app-generic-form [formFields]="sensorDataFields" [loading]="isLoading()"
      (formSubmit)="onCreateSensorDataSubmit($event)" (cancel)="cancelCreate()">
    </app-generic-form>
  </p-dialog>
</div>